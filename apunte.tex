\documentclass[11pt,spanish,a4paper,twoside,openany]{book}
\raggedbottom
% descomentar para debuggear overfull warnings:
% \overfullrule=1mm

\usepackage[
  active=true,
  header=true,
  generate=ejercicios.tex,
  copydocumentclass=false,
  extract-env=ejercicio,
  ejercicio-labels={guia},
  extract-cmd=chapter,
  chapter-nrs={1-9,11,14-18,20},
]{extract}

% Document class para ejercicios.tex.
\begin{extract}
\documentclass[11pt,a4paper]{article}
\end{extract}

% Preámbulo compartido entre apunte y ejercicios.
\begin{extract*}
\tolerance=5000

% Entrada de texto
\usepackage{polyglossia}
\setmainlanguage{spanish}

% Cuestiones de estilo
\usepackage{listings}         % Permite mostrar codigo de forma mas linda
\usepackage{verbatim}         % Permite incluir archivos de texto verbatim

\usepackage{amsmath, amsthm, amssymb} % Se usan para theoremstyle

\usepackage{relsize}
\newcommand{\dificil}{\mathlarger{\mathlarger{\star}}}

\usepackage[table]{xcolor}
\definecolor{light-gray}{gray}{0.96}
\definecolor{med-gray}{gray}{0.8}

\definecolor{keyword}{rgb}{0,0,0.5}
\definecolor{string}{rgb}{0.5,0,0.5}
\definecolor{error}{rgb}{0.5,0,0}

% para poder usar upquote=true (mostrar bien las comillas simples)
\usepackage{textcomp}

\usepackage[labelfont=bf]{caption}

% Parámetros para los listings de python
\lstset{
    language=Python,
    columns=fixed,
    keepspaces=true,
    numbers=left,
    tabsize=4,
    numberstyle=\color{gray}\tiny\ttfamily,
    numbersep=5pt,
    showstringspaces=false,
    basicstyle=\small\ttfamily,
    keywordstyle=\color{keyword},
    backgroundcolor=\color{light-gray},
    commentstyle=\color{gray},
    stringstyle=\color{string},
    morecomment=[s]{>>}{>}, % hack para pintar los prompts >>>
    morecomment=[s]{..}{.}, % y ...
    xleftmargin=\dimexpr\parindent+10pt,
    breaklines=true,
    postbreak=\lst@ifdisplaystyle{\raisebox{0ex}[0ex][0ex]{\ensuremath{\hookrightarrow\space}}}\fi,
}

\lstdefinestyle{inlinecode}{
    backgroundcolor=\color{light-gray}
}

% Para poner partes dentro de los ejercicios
\newcounter{partesi}
\newenvironment{partes}
{   \begin{list}{\alph{partesi})}{
        \usecounter{partesi}
        \setlength{\topsep}{0pt}
        \setlength{\itemsep}{0pt}}}
{   \end{list} }

\usepackage{unicode-math}

\setmainfont
     [ BoldFont       = texgyrepagella-bold.otf ,
       ItalicFont     = texgyrepagella-italic.otf ,
       BoldItalicFont = texgyrepagella-bolditalic.otf ]
     {texgyrepagella-regular.otf}
\setmathfont[Scale=MatchLowercase]{texgyrepagella-math.otf}
\usepackage{DejaVuSansMono}
\setmonofont[Scale=0.9]{DejaVuSansMono}

\usepackage{array}            % Permite alinear los párrafos en las celdas verticalmente
\usepackage{enumitem}
\setlist{labelindent=\parindent, leftmargin=*, align=left, topsep=1.25\parsep,
itemsep=0.5\parsep}

\end{extract*}

% Resto del preámbulo de ejercicios.tex
\begin{extract}

\renewcommand{\baselinestretch}{1.1}
\oddsidemargin 0.0cm \evensidemargin 0.0cm
\setlength{\textwidth}{16cm}

\theoremstyle{definition}
\newtheorem{ejercicio}{Ejercicio}[section]

% Para poder usar los nombres de capítulos como secciones.
% TODO: al omitir capítuos en los ejercicios, las secciones en los ejercicios
% se siguen numerando consecutivamente, y se desacoplan del número de capítulo.
\newcommand{\chapter[2]}{\section{#2}}

\title{75.40 Algoritmos y Programación I \\
    \textbf{Guía de Ejercicios}}
\date{2.\textsuperscript{do} cuatrimestre 2019}

\usepackage[xetex,setpagesize=false,colorlinks]{hyperref}
\hypersetup{%
	linkcolor=black,
	urlcolor=blue,
	pdftitle={Algoritmos y Programación I - Guía de ejercicios},
	bookmarksnumbered,
}%

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\end{extract}

%% Resto del preámbulo solo definido para el apunte. %%

\usepackage[title,titletoc]{appendix}

\usepackage{graphicx}         % Permite insertar imagenes.

\usepackage{longtable}        % tablas largas y flexibles
\usepackage{nonfloat}         % Hace que las figuras no floten
\usepackage{eso-pic}

% Margenes y largo del texto
%
% medidas horizontales
% 1in(fijo) + \hoffset + \(odd|even)sidemargin + \textwidth + \marginparsep +
% \marginparwidth + \marginparpush
%
% medidas verticales
% 1in(fijo) + \voffset + \topmargin + \headheight + \headsep + \textheight +
% \footskip

\setlength\oddsidemargin{-0.04cm}
\setlength\evensidemargin{-0.04cm}
\setlength\topmargin{0cm}
\setlength\headheight{0.5cm}
\setlength\headsep{0.3cm}
\setlength\footskip{0.8cm}
\setlength\textwidth{16cm}  % ancho para apunte
\setlength\textheight{23cm} % largo para apunte

\usepackage{fancyhdr}         %
\pagestyle{fancy}
\fancyhf{} % clear all header and footer fields
\fancyhead[RO]{\slshape \rightmark \hspace{1cm} \normalfont \bfseries \thepage}
\fancyhead[LE]{\bfseries \thepage \hspace{1cm} \normalfont \leftmark}
\renewcommand{\headrulewidth}{0.3pt}
\renewcommand{\footrulewidth}{0pt}

\fancypagestyle{plain}{%
\fancyhf{} % clear all header and footer fields
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}}

\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ #1}{}}

\usepackage{color}            % Permite definir colores
\definecolor{rosa}{rgb}{1,0.90,0.90}
\definecolor{celeste}{rgb}{0.90,0.90,0.95}
\definecolor{verde}{rgb}{0.85,1.00,0.85}
\definecolor{amarillo}{rgb}{1.00,1.00,0.75}

\usepackage[framemethod=tikz]{mdframed}
\usepackage{pgfplots}

\newmdenv[
    font=\small,
    linewidth=0,
    backgroundcolor=celeste,
    nobreak=true
]{observacion}

\newlength{\currentparskip}
\newlength{\currentparindent}

\newenvironment{sabias_que}
{\setlength{\currentparskip}{\parskip}%
\setlength{\currentparindent}{\parindent}%
\begin{figure*}[h!t]\begin{mdframed}[
    font=\small,
    linecolor=black,
    backgroundcolor=verde,
    frametitlefont=\normalsize\bfseries,
    frametitle={$\vcenter{\hbox{\includegraphics[height=4ex]{graficos/lamparita}}}$ Sabías que\ldots},
    frametitlealignment={\hspace*{-\parindent}},
    startinnercode={\setlength{\parskip}{\currentparskip}\setlength{\parindent}{\currentparindent}}
]}{\end{mdframed}\end{figure*}}

\newmdenv[
    font=\small,
    linecolor=black,
    backgroundcolor=amarillo,
    frametitlefont=\normalsize\bfseries,
    frametitle={$\vcenter{\hbox{\includegraphics[height=3ex]{graficos/atencion}}}$ Atención},
    frametitlealignment={\hspace*{-\parindent}},
    nobreak=true
]{atencion}

\newmdenv[
    font=\small,
    backgroundcolor=verde,
    hidealllines=true,
    frametitlerule=true,
    frametitlefont=\normalsize\bfseries,
    frametitle={Referencia Python\hfill$\vcenter{\hbox{\includegraphics[height=4ex]{graficos/logo-python}}}$},
    frametitlealignment={\hspace*{-\parindent}},
	needspace=10\baselineskip
]{referencia_python}

\newenvironment{sintaxis}[1]
  {\needspace{2\baselineskip}\mdfsubtitle[
    subtitlebackgroundcolor=verde,
    subtitleaboveskip=4pt,
    subtitlebelowskip=8pt,
    subtitleinneraboveskip=8pt,
    subtitleinnerbelowskip=0pt
  ]{#1}\parskip=0pt}
  {}

\usepackage{float}            % Agrega estilos a los floats

\floatstyle{ruled}
\newfloat{codigo-float}{htbp}{lop}[chapter]
\floatname{codigo-float}{Código}

\newcommand{\lsthighlight}{\lstset{
    moredelim=**[is][\bfseries]{(@}{@)},
    moredelim=[is][\color{error}]{(^}{^)},
    escapeinside={(~}{~)}
}}
\newcommand{\lstnonumbers}{\lstset{
    numbers=none,
    xleftmargin=\parindent
}}

\newenvironment{codigo}[2]{\begin{codigo-float}
    \caption{{\small\texttt{#1}}\textbf{:}\ \small #2}
    }{\end{codigo-float}}

\lstnewenvironment{codigo-python}{\lsthighlight}{}
\lstnewenvironment{codigo-python-sn}{\lsthighlight\lstnonumbers}{}
\lstnewenvironment{codigo-python-sn-small}{\lsthighlight\lstnonumbers\lstset{basicstyle=\footnotesize\ttfamily}}{}
\lstnewenvironment{codigo-nohl}{\lstset{language={}}\lsthighlight}{}
\lstnewenvironment{codigo-nohl-sn}{\lstset{language={}}\lsthighlight\lstnonumbers}{}

\newcommand{\tituloCodigo}[1]{
\bigskip
\needspace{4cm}
\hrule
\smallskip
{\noindent #1}
\smallskip
\hrule
}

% Numeracion para secciones y subsecciones - Hace falta?
\renewcommand{\thesection}{\thechapter.\arabic{section}}
\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}

% Estilos usados en el texto
\theoremstyle{definition}
\newtheorem{definicion}{Definici\'on}[section]
\newtheorem{ejemplo}{Ejemplo}[section]
\newtheorem{problema}{Problema}[section]
\newtheorem{ejercicio}{Ejercicio}[section]
\newtheorem{ejerciciof}{}[section]
\newtheorem{problemac}{Problema}[chapter]
\newtheorem{ejercicioc}{Ejercicio}[chapter]
\renewcommand{\qedsymbol}{} % El proof inserta dos qed al final
\newenvironment{solucion}[1][Solución]{\begin{proof}[#1]}{\end{proof}}

\theoremstyle{remark}
\newtheorem*{nota}{Nota}

% Traducciones propias
\addto\captionsspanish{
\renewcommand{\chaptername}{Unidad}
\renewcommand{\contentsname}{Contenidos}
}

\def\ra{\rightarrow}

% Para tener hiperlinks, en el panel lateral y en la toc.
\usepackage[xetex,unicode=false,setpagesize=false,colorlinks]{hyperref}
\hypersetup{%
	linkcolor=black,
	urlcolor=blue,
	pdftitle={Algoritmos y Programación I - Aprendiendo a programar usando Python como herramienta},
	bookmarksnumbered,
}%
\usepackage{hypcap}

\usepackage{menukeys}

\usepackage{tikz}
\usetikzlibrary{calc,shapes,arrows,babel,trees,fit,positioning}
\newcommand{\tikzmark}[1]{\tikz[overlay,remember picture] \node (#1) {};}

\tikzset{
    umlattr/.style={right,node font=\ttfamily,draw=none,fill=none,node distance=0pt},
    umltitle/.style={node font=\ttfamily,draw=none,fill=none,node distance=0pt},
    umlattrs/.style={draw=none,fill=none,inner sep=0pt},
    umlclass/.style={draw,fill=none,inner sep=0pt},
    flecha/.style={draw,->,>=latex},
    decision/.style={diamond,draw,aspect=2},
    bloque/.style={rectangle,draw},
    start/.style={circle,draw},
    end/.style={circle,draw,fill},
}

\newcommand*\circled[1]{\tikz[]{
  \node[shape=circle,font=\ttfamily,draw,fill=black,text=white,inner sep=0.5pt] (char) {\tiny{#1}};}}

\usepackage{multirow}

\begin{document}

%\AddToShipoutPictureBG*{%
%  \AtPageLowerLeft{%
%    \hspace{\baselineskip}%
%    \raisebox{\baselineskip}{%
%      \makebox[0pt][l]{Última revisión: \today}}}}

\begin{extract*}
\lstMakeShortInline[style=inlinecode]|
\end{extract*}

\begin{extract} % La guía de estilo para los ejercicios
\maketitle
\thispagestyle{empty}

\newpage

\section*{Recomendaciones al realizar las guías.}

\begin{itemize}
	\item Probá el código que escribas ejecutándolo con el intérprete Python,
        para verificar que tu solución sea correcta.
	\item Prestá atención al leer el enunciado del ejercicio. En particular:
    \begin{itemize}
        \item Revisá si lo que se pide es una \emph{función} o un
            \emph{programa}. Si se pide un programa, se espera que produzcas
            un archivo \verb|.py|, que puede contener varias
            funciones y ser ejecutado con el comando \verb|python3 archivo.py|.
        \item Si se pide que una función \emph{devuelva} o \emph{calcule}
            un valor, la función debe tener una instrucción
            \verb|return| y {\bf no} utilizar las funciones \verb|input| ni
            \verb|print|.
        \item Si se pide que una función o programa \emph{imprima} o
            \emph{muestre} un valor, la función debe llamar a \verb|print|.
        \item Si se pide que una función o programa \emph{pida} o
            \emph{pregunte} un valor al usuaio, debe haber al menos una
            invocación de la función \verb|input|.
    \end{itemize}
    \item Cada ejercicio puede tener muchas soluciones posibles. Una vez que
        encuentres una solución, en lugar de pasar al siguiente ejercicio pensá
        si se te ocurre una solución cuya codificación sea más simple.
	\item Es muy importante que el código que escribas sea lo más claro y legible posible.
    \begin{itemize}
	    \item En particular, los nombres de funciones y variables deben ser descriptivos.
	    \item También prestá atención a los espacios. Por ejemplo, una línea en
            blanco entre las definiciones de función simplifica la lectura del programa.
    \end{itemize}
	\item Los ejercicios marcados con el símbolo $\dificil$ son más difíciles y no son de resolución obligatoria.
	\item No documentes en exceso, pero tampoco ahorres documentación necesaria. La documentación
        debe ser breve y concisa.
    \begin{itemize}
        \item Documentá con \verb|"""| \emph{qué} hace cada una de las funciones
            que desarrolles. ¿Qué parámetros recibe? ¿Qué devuelve? ¿Imprime algo?
            ¿Recibe información del usuario?
        \item En caso de ser necesario, documentá con comentarios (\verb|#|) \emph{cómo} funciona
            el código. Sólo debería ser necesario en secciones de código complejas, donde sea difícil
            entender la intención del código.
    \end{itemize}
\end{itemize}

\newpage

\end{extract}

\title{{\bf Algoritmos y Programación I} \\ Aprendiendo a programar usando Python como herramienta}
\date{2\textsuperscript{da} edición}
\maketitle

\include{0_prologo}
\tableofcontents
\include{1_conceptos}
\include{2_programacion}
\include{3_funciones}
\include{4_decisiones}
\include{5_ciclos}
\include{6_cadenas}
\include{7_tuplas_y_listas}
\include{8_busqueda}
\include{9_diccionarios}
\include{10_contratos}
\include{11_archivos}
\include{13_excepciones}
\include{12_procesamiento}
\include{14_objetos}
%\include{15_herencia_polimorf}
\include{16_Listas} % 15
\include{17_PilasColas} % 16
\include{18_Modelo_de_ejecucion} % 17
\include{19_ordenamiento} % 18
\include{20_ordenamiento_recursivo} % 19
\begin{extract}
\include{ejercicios_c} % 20
\end{extract}

\include{copyright}

\end{document}
